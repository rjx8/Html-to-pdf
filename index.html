<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>محول HTML إلى PDF</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Tahoma', 'Arial', sans-serif;
        }
        
        .code-editor {
            font-family: 'Courier New', monospace;
            direction: ltr;
        }
        
        .preview-frame {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
        }
        
        .print-content {
            display: none;
        }
        
        @media print {
            body * {
                visibility: hidden;
            }
            .print-content, .print-content * {
                visibility: visible;
            }
            .print-content {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                display: block !important;
            }
        }
        
        /* Dark mode support */
        .dark .preview-frame {
            border-color: #374151;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-screen">
    <!-- Dark mode detection -->
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>

    <!-- Header -->
    <header class="bg-white dark:bg-gray-800 shadow-sm border-b no-print">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-6">
                <div class="flex items-center">
                    <div class="text-3xl ml-3">📄</div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900 dark:text-white">محول HTML إلى PDF</h1>
                        <p class="text-sm text-gray-600 dark:text-gray-300">حول أي كود HTML إلى ملف PDF احترافي</p>
                    </div>
                </div>
                <div class="flex items-center space-x-reverse space-x-4">
                    <button onclick="loadSample()" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                        مثال تجريبي
                    </button>
                    <button onclick="clearAll()" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                        مسح الكل
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 no-print">
        <!-- Instructions -->
        <div class="bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-4 mb-6">
            <h2 class="text-lg font-semibold text-blue-800 dark:text-blue-200 mb-2">📝 طريقة الاستخدام:</h2>
            <ol class="list-decimal list-inside text-blue-700 dark:text-blue-300 space-y-1 text-sm">
                <li>الصق كود HTML في المربع</li>
                <li>شاهد المعاينة المباشرة</li>
                <li>اضغط "تحويل إلى PDF" لفتح نافذة جديدة</li>
                <li>اضغط Ctrl+P واختر "Save as PDF"</li>
            </ol>
        </div>

        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- HTML Editor -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm">
                <div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700">
                    <h2 class="text-lg font-semibold text-gray-900 dark:text-white">كود HTML</h2>
                    <div class="flex items-center space-x-reverse space-x-2">
                        <span class="text-sm text-gray-500 dark:text-gray-400" id="charCount">0 حرف</span>
                    </div>
                </div>
                <div class="p-4">
                    <textarea 
                        id="htmlInput" 
                        class="w-full h-96 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white code-editor resize-none text-base"
                        placeholder="الصق كود HTML هنا..."
                        oninput="updatePreview(); updateCharCount();"
                    ></textarea>
                </div>
            </div>

            <!-- Preview -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm">
                <div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700">
                    <h2 class="text-lg font-semibold text-gray-900 dark:text-white">معاينة مباشرة</h2>
                    <button onclick="convertToPDF()" 
                            class="flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors" 
                            id="convertBtn">
                        <span>تحويل إلى PDF</span>
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-4-4m4 4l4-4m5-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </button>
                </div>
                <div class="p-4">
                    <div class="preview-frame h-96 overflow-auto">
                        <iframe id="preview" class="w-full h-full border-0" sandbox="allow-same-origin"></iframe>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features -->
        <div class="mt-12 grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm text-center">
                <div class="text-4xl mb-4">⚡</div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">تحويل سريع</h3>
                <p class="text-gray-600 dark:text-gray-300 text-sm">تحويل فوري من HTML إلى PDF بجودة عالية</p>
            </div>
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm text-center">
                <div class="text-4xl mb-4">🎨</div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">دعم كامل للتصميم</h3>
                <p class="text-gray-600 dark:text-gray-300 text-sm">يحافظ على جميع الألوان والخطوط والتنسيقات</p>
            </div>
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm text-center">
                <div class="text-4xl mb-4">📱</div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">متجاوب</h3>
                <p class="text-gray-600 dark:text-gray-300 text-sm">يعمل على جميع الأجهزة والشاشات</p>
            </div>
        </div>
    </div>

    <!-- Hidden content for PDF conversion -->
    <div id="pdfContent" class="print-content">
        <!-- Content will be inserted here -->
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
            <div class="text-center">
                <div class="text-6xl mb-4">✅</div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">نافذة PDF مفتوحة!</h3>
                <p class="text-gray-600 dark:text-gray-300 mb-4">استخدم Ctrl+P لحفظ الملف كـ PDF</p>
                <button onclick="closeSuccessModal()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                    حسناً
                </button>
            </div>
        </div>
    </div>

    <!-- Error Modal -->
    <div id="errorModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
            <div class="text-center">
                <div class="text-6xl mb-4">❌</div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">خطأ في التحويل</h3>
                <p class="text-gray-600 dark:text-gray-300 mb-4" id="errorMessage">حدث خطأ أثناء تحويل الملف</p>
                <button onclick="closeErrorModal()" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                    إغلاق
                </button>
            </div>
        </div>
    </div>

    <script>
        // Update character count
        function updateCharCount() {
            const input = document.getElementById('htmlInput');
            const count = input.value.length;
            document.getElementById('charCount').textContent = `${count.toLocaleString()} حرف`;
        }

        // Update preview
        function updatePreview() {
            const htmlContent = document.getElementById('htmlInput').value;
            const preview = document.getElementById('preview');
            
            const doc = preview.contentDocument || preview.contentWindow.document;
            doc.open();
            doc.write(htmlContent || '<p style="text-align: center; color: #666; padding: 50px;">ستظهر المعاينة هنا...</p>');
            doc.close();
        }

        // Load sample HTML
        function loadSample() {
            const sampleHTML = `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>مثال تجريبي</title>
    <style>
        body { 
            font-family: 'Tahoma', Arial; 
            padding: 20px; 
            max-width: 800px; 
            margin: 0 auto;
            line-height: 1.6;
        }
        .header { 
            background: #5D5CDE; 
            color: white; 
            padding: 20px; 
            border-radius: 8px; 
            text-align: center; 
            margin-bottom: 20px;
        }
        .content { 
            margin: 20px 0; 
            padding: 20px; 
            border: 1px solid #ddd; 
            border-radius: 8px; 
            background: #f9f9f9;
        }
        .footer { 
            text-align: center; 
            color: #666; 
            margin-top: 20px; 
            border-top: 1px solid #ddd;
            padding-top: 20px;
        }
        ul { 
            background: white; 
            padding: 15px; 
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>مرحباً بك في محول HTML إلى PDF</h1>
        <p>أداة مجانية وسهلة الاستخدام</p>
    </div>
    
    <div class="content">
        <h2>🌟 مميزات المحول</h2>
        <p>يمكنك تعديل هذا الكود أو استبداله بكودك الخاص. هذا المحول يدعم:</p>
        <ul>
            <li>دعم كامل للنصوص العربية</li>
            <li>تصميم احترافي وأنيق</li>
            <li>جودة عالية للطباعة</li>
            <li>سهولة في الاستخدام</li>
            <li>مجاني تماماً</li>
        </ul>
        
        <h3>📋 طريقة الاستخدام:</h3>
        <p>1. ضع كود HTML في المربع الأيسر</p>
        <p>2. شاهد المعاينة في المربع الأيمن</p>
        <p>3. اضغط زر "تحويل إلى PDF"</p>
        <p>4. احفظ الملف من متصفحك</p>
    </div>
    
    <div class="footer">
        <p><strong>تم إنشاؤه بواسطة محول HTML إلى PDF</strong></p>
        <p>أداة مجانية - 2024</p>
    </div>
</body>
</html>`;
            
            document.getElementById('htmlInput').value = sampleHTML;
            updatePreview();
            updateCharCount();
        }

        // Clear all content
        function clearAll() {
            document.getElementById('htmlInput').value = '';
            updatePreview();
            updateCharCount();
        }

        // Convert to PDF - Simple method
        function convertToPDF() {
            const htmlContent = document.getElementById('htmlInput').value.trim();
            
            if (!htmlContent) {
                showError('الرجاء إدخال كود HTML أولاً');
                return;
            }

            try {
                // Create a new window for PDF conversion
                const printWindow = window.open('', '_blank');
                
                // Add print-optimized styles
                const printHTML = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Document PDF</title>
                    <style>
                        @page {
                            size: A4;
                            margin: 1cm;
                        }
                        body {
                            font-family: Arial, 'Tahoma', sans-serif;
                            line-height: 1.6;
                            color: #333;
                            max-width: 100%;
                            margin: 0;
                            padding: 0;
                        }
                        * {
                            box-sizing: border-box;
                        }
                        img {
                            max-width: 100%;
                            height: auto;
                        }
                        table {
                            width: 100%;
                            border-collapse: collapse;
                        }
                        @media print {
                            body { margin: 0; }
                        }
                    </style>
                </head>
                <body>
                    ${htmlContent}
                </body>
                </html>
                `;
                
                printWindow.document.open();
                printWindow.document.write(printHTML);
                printWindow.document.close();
                
                // Wait for content to load then focus for printing
                setTimeout(() => {
                    printWindow.focus();
                    showSuccess();
                }, 500);
                
            } catch (error) {
                console.error('Error:', error);
                showError('حدث خطأ أثناء فتح نافذة التحويل');
            }
        }

        // Show success modal
        function showSuccess() {
            document.getElementById('successModal').classList.remove('hidden');
            document.getElementById('successModal').classList.add('flex');
        }

        // Close success modal
        function closeSuccessModal() {
            document.getElementById('successModal').classList.add('hidden');
            document.getElementById('successModal').classList.remove('flex');
        }

        // Show error modal
        function showError(message) {
            document.getElementById('errorMessage').textContent = message;
            document.getElementById('errorModal').classList.remove('hidden');
            document.getElementById('errorModal').classList.add('flex');
        }

        // Close error modal
        function closeErrorModal() {
            document.getElementById('errorModal').classList.add('hidden');
            document.getElementById('errorModal').classList.remove('flex');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateCharCount();
            updatePreview();
        });
    </script>
</body>
</html>